     1                                  extern printf
     2                                  
     3                                  global sum
     4                                  
     5                                  segment .data
     6                                  
     7                                  segment .bss
     8                                  
     9                                  segment .text
    10 00000000 5468652073756D2E61-     welcome_message db "The sum.asm module has begun executing", 10, 0
    10 00000009 736D206D6F64756C65-
    10 00000012 206861732062656775-
    10 0000001B 6E2065786563757469-
    10 00000024 6E670A00           
    11 00000028 52313020636F6E7461-     print_i db "R10 contains: %d", 10, 0
    11 00000031 696E733A2025640A00 
    12                                  
    13                                  sum:
    14                                  
    15 0000003A 55                      push rbp                                                    ;Backup the base pointer
    16 0000003B 4889E5                  mov  rbp,rsp                                                ;Advance the base pointer to start of the current stack frame
    17 0000003E 57                      push rdi                                                    ;Backup rdi
    18 0000003F 56                      push rsi                                                    ;Backup rsi
    19 00000040 52                      push rdx                                                    ;Backup rdx
    20 00000041 51                      push rcx                                                    ;Backup rcx
    21 00000042 4150                    push r8                                                     ;Backup r8
    22 00000044 4151                    push r9                                                     ;Backup r9
    23 00000046 4152                    push r10                                                    ;Backup r10
    24 00000048 4153                    push r11                                                    ;Backup r11: printf often changes r11
    25 0000004A 4154                    push r12                                                    ;Backup r12
    26 0000004C 4155                    push r13                                                    ;Backup r13
    27 0000004E 4156                    push r14                                                    ;Backup r14
    28 00000050 4157                    push r15                                                    ;Backup r15
    29 00000052 53                      push rbx                                                    ;Backup rbx
    30 00000053 9C                      pushf                                                       ;Backup rflags
    31                                  ;--------------------------------------------------------------------------------------------------
    32                                  
    33 00000054 B800000000              mov rax, 0
    34 00000059 48BF-                   mov rdi, welcome_message
    34 0000005B [0000000000000000] 
    35 00000063 E8(00000000)            call printf
    36                                  
    37 00000068 41BA00000000            mov r10, 0 ;sum of all the indexes
    38 0000006E 4D0317                  add r10, [r15+8*0]
    39 00000071 4D035708                add r10, [r15+8*1]
    40 00000075 4D035710                add r10, [r15+8*2]
    41 00000079 4D035718                add r10, [r15+8*3]
    42 0000007D 4D035720                add r10, [r15+8*4]
    43                                  
    44 00000081 B800000000              mov rax, 0
    45 00000086 48BF-                   mov rdi, print_i
    45 00000088 [2800000000000000] 
    46 00000090 4C89D6                  mov rsi, r10
    47 00000093 E8(00000000)            call printf
    48                                  
    49                                  ;--------------------------------------------------------------------------------------------------
    50 00000098 9D                      popf                                                        ;Restore rflags
    51 00000099 5B                      pop rbx                                                     ;Restore rbx
    52 0000009A 415F                    pop r15                                                     ;Restore r15
    53 0000009C 415E                    pop r14                                                     ;Restore r14
    54 0000009E 415D                    pop r13                                                     ;Restore r13
    55 000000A0 415C                    pop r12                                                     ;Restore r12
    56 000000A2 415B                    pop r11                                                     ;Restore r11
    57 000000A4 415A                    pop r10                                                     ;Restore r10
    58 000000A6 4159                    pop r9                                                      ;Restore r9
    59 000000A8 4158                    pop r8                                                      ;Restore r8
    60 000000AA 59                      pop rcx                                                     ;Restore rcx
    61 000000AB 5A                      pop rdx                                                     ;Restore rdx
    62 000000AC 5E                      pop rsi                                                     ;Restore rsi
    63 000000AD 5F                      pop rdi                                                     ;Restore rdi
    64 000000AE 5D                      pop rbp                                                     ;Restore rbp
    65                                  
    66 000000AF C3                      ret
